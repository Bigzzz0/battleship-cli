# เกม Battleship Board Game CLI

นี่คือเกม Battleship แบบ Command-Line Interface ที่พัฒนาขึ้นเป็นโปรเจกต์ย่อย

**ลิงก์ Google Colab:** [https://colab.research.google.com/drive/1h75_nN5lcmN3DCmuBE58Rn5l0spMxP20?usp=sharing](https://colab.research.google.com/drive/1h75_nN5lcmN3DCmuBE58Rn5l0spMxP20?usp=sharing)

## เป้าหมายของโปรเจกต์

เป้าหมายหลักของโปรเจกต์นี้คือ:

* ตั้งค่าโครงสร้างโปรเจกต์พื้นฐานบน GitHub
* แสดงผลกระดานเกมเปล่าบน Command Line Interface (CLI)
* พัฒนาการเริ่มต้นและจบการทำงานของโปรแกรม
* พัฒนาระบบการวางเรือบนกระดานแบบสุ่มโดยไม่ให้เรือซ้อนทับกัน
* รองรับการรับตำแหน่งการยิงจากผู้เล่นและตรวจสอบความถูกต้องของ Input
* แสดงผลกระดานที่อัปเดตหลังการยิง (บอกว่าโดนเรือหรือไม่)
* ตรวจสอบเงื่อนไขการจมเรือและแจ้งผู้เล่นเมื่อเรือถูกจม
* ตรวจสอบเงื่อนไขการจบเกมเมื่อเรือทุกลำถูกจม
* ปรับปรุงคุณภาพโค้ดและเพิ่ม Unit Tests
* ปรับปรุง User Interface (UI) บน Command Line ให้ดีขึ้น
* จัดทำเอกสารประกอบโปรเจกต์
* ทำการทดสอบภาพรวมของเกม (End-to-End Testing)

## สรุปผลการทำงานรายสัปดาห์ (Sprints Summary)

### Sprint 1 (สัปดาห์ที่ 1)

**เป้าหมาย:**
* ตั้งค่าโปรเจกต์บน GitHub และสร้าง repository พื้นฐาน
* แสดงผลกระดานเกมเปล่าขนาดมาตรฐาน (เช่น 10x10) บน Command Line ได้
* โปรแกรมสามารถเริ่มต้นและจบการทำงานได้ (อาจจะด้วยการกดปุ่มหรือพิมพ์คำสั่ง 'quit')

**ความสำเร็จที่สำคัญ:**
* สร้าง GitHub repository เรียบร้อย
* พัฒนาการแสดงผลกระดานพื้นฐานพร้อมหัวข้อแถว/คอลัมน์และสัญลักษณ์เปล่า ('.')
* โปรแกรมสามารถเริ่มต้นและจบการทำงานได้โดยไม่มีข้อผิดพลาด

### Sprint 2 (สัปดาห์ที่ 2)

**เป้าหมาย:**
* พัฒนาระบบสำหรับวางเรือบนกระดานเกมแบบสุ่มให้สมบูรณ์ โดยไม่ให้เรือซ้อนทับกัน
* รองรับการรับตำแหน่งการยิงจากผู้เล่นและตรวจสอบความถูกต้องของ Input ได้อย่างครอบคลุม (รวมถึงการยิงซ้ำ)
* แสดงผลกระดานที่อัปเดตหลังการยิง (บอกว่าโดนเรือหรือไม่) และแสดงสัญลักษณ์ที่ถูกต้อง ('H' สำหรับ Hit, 'M' สำหรับ Miss)
* ตรวจสอบเงื่อนไขการจมเรือและแจ้งผู้เล่นเมื่อเรือถูกจม (ระบุชื่อเรือที่จมได้)
* ตรวจสอบเงื่อนไขการจบเกมเมื่อเรือทุกลำถูกจมและจบเกมอย่างถูกต้อง

**ความสำเร็จที่สำคัญ:**
* เริ่มต้นการวางเรือแบบสุ่ม (ยังมีประเด็นเรือทับซ้อนที่ต้องแก้ไข)
* พัฒนาการรับ Input และแปลงพิกัดพื้นฐาน
* กระดานแสดงผล 'H' และ 'M' หลังการยิง (ต้องปรับปรุงให้แสดงเฉพาะจุดที่ยิงโดน)
* พัฒนา Game Loop พื้นฐานพร้อมคำสั่ง 'quit'

**สิ่งที่ยังต้องทำเพิ่มเติมใน Sprint 2 (นำไปทำใน Sprint 3):**
* ปรับปรุง logic การวางเรือเพื่อป้องกันการทับซ้อน
* ปรับปรุง logic ในฟังก์ชัน `take_shot` เพื่อ: แสดงข้อความ Hit/Miss, อัปเดตสัญลักษณ์ 'H' เฉพาะจุดที่ยิง, จัดการการยิงซ้ำ, ตรวจจับเรือจม
* อัปเดต logic ในฟังก์ชัน `all_ships_sunk`
* เพิ่มข้อความแสดงความยินดีเมื่อชนะ

### Sprint 3 (สัปดาห์ที่ 3)

**เป้าหมาย:**
* Implement ฟังก์ชันที่ยังค้างอยู่จาก Sprint 2 ให้เสร็จสมบูรณ์
* ปรับปรุงโค้ดให้มีความเรียบร้อย (Clean Code) และมีประสิทธิภาพ
* เพิ่ม Unit Tests เพื่อให้ครอบคลุม logic ที่สำคัญ
* ปรับปรุง User Interface (UI) บน Command Line ให้ดีขึ้น
* จัดทำเอกสารประกอบโปรเจกต์
* ทำการทดสอบภาพรวมของเกม (End-to-End Testing) เพื่อให้แน่ใจว่าทุกอย่างทำงานถูกต้อง

**ความสำเร็จที่สำคัญ:**
* Implement logic การแสดงข้อความ "Miss!" และ "Hit!"
* อัปเดตสัญลักษณ์ 'H' ที่ตำแหน่งที่ยิงโดนถูกต้อง
* เพิ่มการจัดการสำหรับการยิงซ้ำ
* Implement logic การตรวจจับเรือที่จมและแจ้งชื่อเรือที่จม
* เพิ่มข้อความแสดงความยินดีเมื่อผู้เล่นชนะ
* จัดระเบียบโค้ดโดยใช้ชื่อตัวแปร/ฟังก์ชันที่สื่อความหมายและเพิ่ม Comment
* เพิ่ม Unit Tests ครอบคลุมฟังก์ชันหลัก (`Board` และ `BattleShipGame`)
* ปรับปรุงการแสดงผลกระดานบน CLI ให้อ่านง่ายขึ้น
* สร้างไฟล์ README.md (ไฟล์นี้!)
* สามารถเล่นเกมได้ตั้งแต่ต้นจนจบโดยไม่มีข้อผิดพลาดร้ายแรง

## วิธีการเล่น

1. Clone repository จาก [https://github.com/Bigzzz0/battleship-cli](https://github.com/Bigzzz0/battleship-cli)
2. เข้าไปยัง directory ของโปรเจกต์ใน terminal
3. รันไฟล์ Python หลัก (เช่น `python main.py`)
4. ทำตามคำแนะนำบนหน้าจอเพื่อป้อนพิกัด (เช่น `A1`, `J10`)
5. พิมพ์ `quit` เพื่อออกจากเกมได้ทุกเมื่อ

## โครงสร้างโค้ด

* `main.py`: ประกอบด้วย Game Loop หลักและคลาส `BattleShipGame`
* `board.py`: ประกอบด้วยคลาส `Board` ซึ่งรับผิดชอบการจัดการกระดานและตำแหน่งเรือ
* `tools.py`: ประกอบด้วยฟังก์ชัน Utility ต่างๆ เช่น `parse_position` และ `is_valid_position`
* `tests/`: Directory ที่เก็บ Unit Tests

## ผู้ร่วมพัฒนา

* **บิ๊ก (Planner / Coder):** วางแผนโปรเจกต์, ตั้งค่า repository, ออกแบบโครงสร้างโดยรวม
* **อาต (Coder / Debugger ):** Implement logic หลักของเกม, การวางเรือ, การจัดการการยิง
* **แทน (Debugger / Planner ):** การทดสอบ, การ Debug, การรีวิวโค้ด, จัดทำเอกสาร

## การพัฒนาเพิ่มเติมในอนาคต

* เพิ่มคู่ต่อสู้ที่เป็นคอมพิวเตอร์
* Implement โหมดเกมที่หลากหลายขึ้น (เช่น ขนาดกระดาน, ประเภทเรือ)
* ปรับปรุงการจัดการข้อผิดพลาด (Error Handling) เพื่อการตรวจสอบ Input ที่แข็งแกร่งขึ้น
* เพิ่มองค์ประกอบกราฟิก (แม้จะยังคงเป็น CLI)


## ภาพรวมสถาปัตยกรรมปัจจุบัน
=======

## ภาพรวมสถาปัตยกรรมปัจจุบัน
=======
### Sprint 4 (Final Week)


โค้ดได้รับการยกระดับจาก CLI พื้นฐานสู่ระบบ Client-Server ที่สมบูรณ์ โดยประกอบด้วยสองส่วนหลัก:

* **Backend (`app/`)** – พัฒนาโดยใช้ FastAPI ให้บริการ REST API สำหรับสร้างเกมใหม่ ดึงสถานะเกม ยิงกระสุน สลับเทิร์นกับ AI และตรวจสอบประวัติ/สถิติการเล่น โค้ดแกนหลักแบ่งเป็นโมดูลย่อย ได้แก่
  * `app/main.py` – กำหนด FastAPI application, middleware และเส้นทาง API ทั้งหมด เช่น `/games`, `/games/{game_id}/fire`, `/ships/validate` เป็นต้น
  * `app/services/game_service.py` – บริการจัดการสถานะเกมในหน่วยความจำ ดูแลกระดานของผู้เล่น/AI, จัดการเทิร์น, ประมวลผลการยิง, สรุปผลการชนะ และรวบรวมสถิติ
  * `app/models/board.py` – โมเดลกระดานที่รับผิดชอบการวางเรือแบบสุ่ม/กำหนดเอง ตรวจสอบการชน และตัดสินผลการยิง (`hit`, `miss`, `already_shot`)
  * `app/models/game_history.py` – บันทึกประวัติการยิง แสดงผลสถิติ (อัตรา Hit, จำนวนยิง, ผู้ชนะ, ระยะเวลาเกม)
  * `app/core/ai_opponent.py` – ระบบ AI 4 ระดับ (Easy, Medium, Hard, Expert) พร้อมกลยุทธ์เชิงน่าจะเป็น, checkerboard pattern, hunt mode และการทำนายเป้าหมายล่วงหน้า
  * `app/core/utils.py` – ฟังก์ชันอรรถประโยชน์ เช่น การแปลงตำแหน่ง `A1` ให้เป็นพิกัดแถว/คอลัมน์ และ helper สำหรับการจัดสีข้อความ CLI

* **Frontend (`battleship-frontend/`)** – เว็บแอป React + Vite + Tailwind แสดงกระดานสองฝั่งแบบเรียลไทม์ มีคอมโพเนนต์สำหรับเลือกระดับความยาก AI, ปุ่มสร้างเกม, แผงสถานะ AI/เกม และการแสดงผลการยิงแบบโต้ตอบ สามารถใช้งานร่วมกับ backend ผ่าน REST API

รายละเอียดเชิงโครงสร้างของ repository ทั้งหมดดูได้จากไฟล์ [`PROJECT_STRUCTURE.md`](PROJECT_STRUCTURE.md) ที่มีผังและคำอธิบายโฟลเดอร์อย่างละเอียด

## คุณลักษณะเด่นใน Sprint 4 (Final Week)

สัปดาห์สุดท้ายของการพัฒนามุ่งเน้นการยกระดับจาก CLI ไปสู่ประสบการณ์ผู้เล่นครบวงจร โดยฟีเจอร์สำคัญที่เพิ่มเข้ามา ได้แก่:

* **ระบบ AI ขั้นสูง:** เพิ่มระดับความยาก Expert พร้อมอัลกอริทึมวิเคราะห์ความน่าจะเป็นและเรียนรู้ทิศทางของเรือจากประวัติการยิง (`app/core/ai_opponent.py`)
* **โหมดเล่นกับคอมพิวเตอร์แบบสองกระดาน:** ผู้เล่นและ AI มีบอร์ดแยกกัน ช่วยให้เกมเหมือนต้นฉบับมากขึ้น (`game_service.py`)
* **การติดตามประวัติและสถิติอย่างละเอียด:** ทุกการยิงถูกเก็บพร้อม timestamp, ผู้ยิง, ผลลัพธ์ และสถานะเรือ จึงสามารถแสดง hit rate, ระยะเวลาเกม และผู้ชนะได้ (`game_history.py`)
* **API ครบถ้วนสำหรับ Frontend/Web UI:** มี endpoint สำหรับสร้างเกม, ยิงกระสุน, ให้ AI ยิง, ดูสถานะเกม, ดูประวัติ, ดูสถิติ และตรวจสอบการวางเรือแบบ custom
* **อินเทอร์เฟซเว็บสมัยใหม่:** React frontend แสดงกระดานสองฝั่ง, ตัวบ่งชี้เทิร์น, ปุ่มควบคุม AI และหน้าต่างสถิติแบบเรียลไทม์ พร้อมสีสันและไอคอนเพื่อความเข้าใจง่าย (`battleship-frontend/src/`)
* **การทดสอบ End-to-End:** มีรายงาน `TESTING_RESULTS.md` และ `ENHANCED_TESTING_RESULTS.md` ที่บันทึกการทดสอบการเล่นจริง ครอบคลุมการสร้างเกม, ยิงสลับเทิร์น, ตรวจสอบสถิติ, และพฤติกรรมของ Expert AI

สำหรับคำอธิบายละเอียดราย Sprint และภาพรวมการพัฒนาทั้งหมด ดูเพิ่มเติมได้ที่ [`Final Sprint(Week4).md`](Final%20Sprint(Week4).md) และ `FINAL_DELIVERY.md`

## การติดตั้งและเริ่มต้นใช้งาน

### ข้อกำหนดเบื้องต้น

* Python 3.10 ขึ้นไป
* Node.js 18 ขึ้นไป และ npm
* pip สำหรับจัดการแพ็กเกจ Python
* (ตัวเลือก) Docker และ Docker Compose หากต้องการรันผ่านคอนเทนเนอร์

### ติดตั้ง Backend

```bash
# ติดตั้ง dependencies
pip install -r requirements.txt

# รันเซิร์ฟเวอร์ FastAPI
uvicorn app.main:app --reload
```

เซิร์ฟเวอร์จะทำงานที่ `http://localhost:8000` และมีเอกสาร Swagger UI อัตโนมัติที่ `http://localhost:8000/docs`

### ติดตั้ง Frontend

```bash
cd battleship-frontend
npm install
npm run dev
```

เปิดเบราว์เซอร์ที่ `http://localhost:5173` เพื่อเริ่มเล่นผ่านเว็บอินเทอร์เฟซ ระบบจะเชื่อมต่อกับ backend ที่รันอยู่บนพอร์ต 8000 โดยอัตโนมัติ (CORS เปิดใช้งานสำหรับทุก origin)

### รันด้วย Docker (เลือกได้)

```bash
docker-compose up --build
```

คำสั่งนี้จะสร้างและรันทั้ง backend และ frontend พร้อมกัน

### เล่นผ่าน CLI ดั้งเดิม (อาจใช้สำหรับการทดลอง)

หากต้องการทดลองเวอร์ชัน CLI แบบดั้งเดิม สามารถนำสคริปต์ต้นฉบับจาก Sprint ก่อน ๆ (ดูใน Google Colab link) มารันภายในสภาพแวดล้อม Python ได้ อย่างไรก็ตามเวอร์ชันหลักที่ส่งมอบคือ FastAPI + React

## สรุป API หลัก

| Method | Endpoint | คำอธิบาย |
| ------ | -------- | --------- |
| `GET` | `/` | ตรวจสอบสถานะ API |
| `POST` | `/games` | สร้างเกมใหม่ (ระบุว่าจะเล่นกับ AI และระดับความยากได้) |
| `GET` | `/games/{game_id}` | ดูสถานะปัจจุบันของเกม (สามารถเปิด debug_mode ได้) |
| `GET` | `/games/{game_id}/debug` | ดึงสถานะเกมพร้อมตำแหน่งเรือ (สำหรับ debug) |
| `POST` | `/games/{game_id}/fire` | ผู้เล่นยิงใส่กระดานฝ่ายตรงข้าม |
| `POST` | `/games/{game_id}/ai-shot` | ให้ AI ยิงใส่กระดานผู้เล่น |
| `GET` | `/games/{game_id}/history` | ดูประวัติการยิงทั้งหมด |
| `GET` | `/games/{game_id}/statistics` | ดูสถิติรวมของเกม |
| `GET` | `/games/{game_id}/ai-stats` | ดูสถิติและกลยุทธ์ปัจจุบันของ AI |
| `GET` | `/ships` | ข้อมูลเรือทั้งหมด (ชื่อและขนาด) |
| `POST` | `/ships/validate` | ตรวจสอบความถูกต้องของการวางเรือแบบ custom |

ดูรายละเอียดการส่งข้อมูล (request/response schema) ได้จากไฟล์ `app/main.py`

## ระบบ AI Opponent

AI ของเกมถูกออกแบบให้ตอบสนองผู้เล่นทุกระดับความสามารถ โดยมีรายละเอียดดังนี้:

* **Easy:** ยิงแบบสุ่ม 100% ไม่จำค่าการยิงก่อนหน้า
* **Medium:** ยิงแบบสุ่ม แต่เมื่อยิงโดนจะจดจำและพยายามยิงรอบ ๆ จุดนั้น
* **Hard:** ใช้แพทเทิร์น checkerboard เพื่อตามหาเรืออย่างมีประสิทธิภาพ พร้อมโหมดล่า (hunt mode)
* **Expert:** วิเคราะห์ความน่าจะเป็นของตำแหน่งเรือทั้งหมด ประเมินลำดับเป้าหมาย และคาดการณ์การยิงครั้งต่อไป 3 ตำแหน่ง พร้อมแสดงสถิติการเล่นและรายละเอียดกลยุทธ์แบบเรียลไทม์

รายละเอียดการทำงานอยู่ในไฟล์ `app/core/ai_opponent.py` และอธิบายเพิ่มในเอกสาร `Final Sprint(Week4).md`

## การทดสอบและการประกันคุณภาพ

โปรเจกต์มีการทดสอบทั้งเชิงระบบและเชิงประสบการณ์ผู้ใช้ โดยบันทึกผลไว้ในเอกสารต่อไปนี้:

* [`TESTING_RESULTS.md`](TESTING_RESULTS.md) – รายงานสถานการณ์การทดสอบหลัก ครอบคลุมการสร้างเกม, การสลับเทิร์น, การทำงานของสถิติ และ UI/UX โดยสรุปผลว่า "ผ่าน" ทุกหัวข้อ
* [`ENHANCED_TESTING_RESULTS.md`](ENHANCED_TESTING_RESULTS.md) – ขยายผลทดสอบโดยเจาะลึกระบบ Expert AI และสองกระดาน
* `FINAL_DELIVERY.md` – สรุปการส่งมอบ พร้อมไฮไลต์ฟีเจอร์และขั้นตอนการติดตั้ง

สามารถรันชุดทดสอบอัตโนมัติ (ถ้ามีการเพิ่มในอนาคต) ผ่าน `pytest` หรือสคริปต์ที่เกี่ยวข้องได้ โดยปัจจุบันการตรวจสอบหลักเป็นการทดสอบด้วยตนเองตามเอกสารข้างต้น

## เอกสารประกอบอื่น ๆ

* [`PROJECT_STRUCTURE.md`](PROJECT_STRUCTURE.md) – ผังโครงสร้าง repository และคำอธิบายแต่ละโฟลเดอร์
* [`Final Sprint(Week4).md`](Final%20Sprint(Week4).md) – รายงานความคืบหน้าล่าสุด เทียบกับ Sprint 3
* `FINAL_DELIVERY.md` – เอกสารสรุปฟีเจอร์ที่สำเร็จและไฮไลต์สำคัญก่อนส่งมอบ

## โรดแมปถัดไป

แนวคิดสำหรับเวอร์ชันถัดไป ได้แก่ โหมดผู้เล่นหลายคน, การบันทึก/โหลดเกม, ระบบจัดอันดับ, การเชื่อมฐานข้อมูลเพื่อเก็บสถิติถาวร และการพัฒนาเป็น Progressive Web App (PWA) เพื่อรองรับอุปกรณ์พกพา

หากมีคำถามหรือข้อเสนอแนะเพิ่มเติม สามารถเปิด issue ใหม่ใน repository ได้ทันที ขอบคุณที่สนใจโปรเจกต์ Battleship Board Game CLI! ⚓
